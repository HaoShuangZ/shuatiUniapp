"use strict";const e=require("../../common/vendor.js"),d=require("../../utils/config.js");if(!Array){const a=e.resolveComponent("uni-popup-dialog"),s=e.resolveComponent("uni-popup");(a+s)()}const g=()=>"../../uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.js",f=()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js";Math||(g+f)();const m={__name:"docView",setup(a){e.getCurrentInstance().appContext.config.globalProperties,e.onLoad(i=>{console.log(i,"跳转携带的参数",e.index.getStorageSync("docDetail"))}),e.onShow(()=>{Object.assign(t,{...e.index.getStorageSync("docDetail")})});const c=e.ref(null),r=e.index.getStorageSync("userInfo"),l=i=>{if(!r.vipFlag){e.index.showModal({title:"提示",content:"您未开通VIP,开通后可以下载!",confirmText:"去开通",success:function(o){o.confirm?e.index.navigateTo({url:"../../pages/vip/vip"}):o.cancel&&console.log("用户点击取消")}});return}e.index.showToast({title:"加载中",icon:"loading"}),e.index.downloadFile({url:`${d.baseUrl}/document/download?downloadFlag=${i}`,header:{"Ac-Token":e.index.getStorageSync("token")||""},success:o=>{if(console.log(o,"下载的res"),o.statusCode===200){if(o.header["Content-Type"]==="application/json;charset=utf-8"){console.log("res----",o),e.index.showToast({title:"下载次数已上限!",icon:"error"});return}e.index.saveFile({tempFilePath:o.tempFilePath,success:n=>{console.log("e下载文件的地址",n),setTimeout(()=>{e.index.hideLoading(),e.index.openDocument({filePath:n.savedFilePath,success:u=>{console.log("openDocument",u)},fail:u=>{e.index.showToast({title:"打开失败"+u})}})},200)},fail:n=>{e.index.showToast({title:"保存失败"+n})}})}},fail:o=>{e.index.showToast({title:"文件下载失败"+o,icon:"none"})}})};let t=e.reactive({});return(i,o)=>({a:e.t(e.unref(t).docName),b:e.t(e.unref(t).type),c:e.unref(t).type===".docx"?"../../static/doc.png":`../../static/${e.unref(t).type}.png`,d:e.t(e.unref(t).updateTime),e:e.t(e.unref(t).freeFlag?"免费":"开通VIP下载"),f:e.f(e.unref(t).tags,(n,u,p)=>({a:e.t(n),b:n})),g:e.f(e.unref(t).previewImages,(n,u,p)=>({a:n,b:n})),h:e.o(n=>l(e.unref(t).downloadFlag)),i:e.o(i.dialogConfirm),j:e.o(i.dialogClose),k:e.p({type:"error",cancelText:"取消",confirmText:"去开通",title:"提示",content:"您未开通VIP,开通后可以下载!"}),l:e.sr(c,"39c07f28-0",{k:"alertDialog"}),m:e.p({type:"dialog"}),n:e.sr("popup","39c07f28-2"),o:e.o(i.change),p:e.p({["background-color"]:"#fff"})})}},_=e._export_sfc(m,[["__file","C:/Users/sygen/Documents/HBuilderProjects/brushQuestion-front/pages/docView/docView.vue"]]);wx.createPage(_);
