"use strict";const o=require("../../common/vendor.js"),u=require("../../utils/util.js"),c=require("../../utils/wechat.js");require("../../utils/http.js");require("../../utils/config.js");require("../../utils/api.js");const m={data(){return{isChecked:!1,userPhone:"158*****8022",loginType:1,buttonText:"立即注册",disabledCode:!1,codeText:"获取验证码",styles:{width:"70%!important"},formData:{phone:"",code:"",password:"",repassword:""},rules:{phone:{rules:[{required:!0,errorMessage:"手机号必填"},{validateFunction:function(s,i,l,e){return i.length<11?e("请输入11位手机号"):u.checkPhoneNumber(i)||e("手机号格式不正确"),!0}}]},password:{rules:[{required:!0,errorMessage:"请输入密码"},{trigger:"blur",validateFunction:function(s,i,l){i===""&&l(new Error("请输入密码"))}}]},repassword:{rules:[{required:!0,errorMessage:"确认密码不能为空"},{trigger:"blur",validateFunction:(s,i,l,e)=>{i===""?e("请再次输入密码"):i!==this.formData.password&&(e("两次输入密码不一致!"),this.$refs.form.validateField("password"))}}]},code:{rules:[{require:!0,errorMessage:"验证码不能为空"},{validateFunction:function(s,i,l,e){i.length<4&&e("验证码为四位数字")}}]}}}},onReady(){},onLoad(){u.getNavBarHieht()},mounted(){},methods:{getPhoneNumber(r){if(this.isChecked)console.log(r.detail,"eeeeee"),c.wechat.getUserPhone(r.detail);else{o.index.showToast({title:"需同意服务条款",icon:"error"});return}},bindGetUserInfo(r){console.log(r,"获取用户信息")},loginPhoneClick(){this.loginType=2},loginIconClick(){this.loginType=1},checkedRadio(){console.log("this.isChecked",this.isChecked),this.isChecked=!this.isChecked},formSubmit(r){this.$refs.form.validate().then(s=>{console.log("表单数据信息：",s);let i={params:{phone:s.phone,code:s.code},callBack:l=>{o.index.setStorageSync("token",l.token),o.index.setStorageSync("userInfo",l),o.index.showToast({title:"登陆成功",icon:"success"}),setTimeout(()=>{o.index.switchTab({url:"/pages/my/my"})},1e3)}};this.$http("phoneCodeLogin",i)}).catch(s=>{console.log("表单错误信息：",s)})},formReset(){},onSendCode(){this.$refs.form.validateField("phone").then(r=>{console.log(r,"手机号校验");let s=this,i=60;s.getPhoneCode();let l=setInterval(function(){this.disabledCode=!0,i===0?(s.disabledCode=!1,clearInterval(l),s.codeText="发送验证码",i=60):(s.codeText=`${i}秒后重发`,i--)},1e3)}).catch(r=>{console.log("手机号必填",r)})},getPhoneCode(){let r={params:{phone:this.formData.phone},callBack:s=>{console.log(s,"getPhoneCode"),o.index.showToast({title:"验证码发送成功"})}};this.$http("getPhoneCode",r)},region(){console.log("this.buttonText",this.buttonText),this.loginType=this.loginType===2?3:2,this.buttonText=this.loginType===2?"立即注册":"返回登陆",console.log("立即注册")},forget(){this.loginType=4,this.buttonText="返回登陆",console.log("忘记密码")},goText(r){console.log("type ---",r);let s=r=="server"?"./server":"./text/privacy";console.log(s),o.index.navigateTo({url:"./server"})}}};if(!Array){const r=o.resolveComponent("uni-easyinput"),s=o.resolveComponent("uni-forms-item"),i=o.resolveComponent("uni-icons"),l=o.resolveComponent("uni-forms");(r+s+i+l)()}const p=()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js",h=()=>"../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js",g=()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js",d=()=>"../../uni_modules/uni-forms/components/uni-forms/uni-forms.js";Math||(p+h+g+d)();function a(r,s,i,l,e,t){return o.e({a:e.loginType===4},e.loginType===4?{}:{},{b:e.loginType===1},e.loginType===1?o.e({c:!e.isChecked},e.isChecked?{e:o.o((...n)=>t.getPhoneNumber&&t.getPhoneNumber(...n))}:{d:o.o((...n)=>t.getPhoneNumber&&t.getPhoneNumber(...n))}):{},{f:e.loginType===2},e.loginType===2?{g:o.o(n=>e.formData.phone=n),h:o.p({trim:"all",maxlength:"11",type:"number",placeholder:"请输入手机号",modelValue:e.formData.phone}),i:o.p({name:"phone"})}:{},{j:e.loginType===2||e.loginType===3},e.loginType===2||e.loginType===3?{k:o.o(n=>e.formData.code=n),l:o.p({styles:e.styles,maxlength:"6",type:"number",placeholder:"请输入验证码",modelValue:e.formData.code}),m:o.t(e.codeText),n:o.n(e.disabledCode==!0?"code_text_tap":"code_text"),o:o.o((...n)=>t.onSendCode&&t.onSendCode(...n)),p:e.disabledCode,q:o.p({name:"code"})}:{},{r:e.loginType===3||e.loginType===4},e.loginType===3||e.loginType===4?{s:o.o(n=>e.formData.password=n),t:o.p({type:"password",placeholder:"请输入密码",modelValue:e.formData.password}),v:o.p({trim:"all",name:"password"})}:{},{w:e.loginType===4},e.loginType===4?{x:o.o(n=>e.formData.repassword=n),y:o.p({type:"password",placeholder:"请再次输入新密码",modelValue:e.formData.repassword}),z:o.p({trim:"all",name:"repassword"})}:{},{A:e.loginType!==1},e.loginType!==1?{B:o.t(e.loginType===3?"注册":"登陆"),C:o.o((...n)=>t.formSubmit&&t.formSubmit(...n))}:{},{D:e.isChecked,E:o.o((...n)=>t.checkedRadio&&t.checkedRadio(...n)),F:o.o(n=>t.goText("server")),G:o.o(n=>t.goText("privacy")),H:e.loginType!==1},e.loginType!==1?{I:o.p({type:"paperplane-filled",size:"30"}),J:o.o((...n)=>t.loginIconClick&&t.loginIconClick(...n))}:{},{K:e.loginType===1},e.loginType===1?{L:o.o((...n)=>t.loginPhoneClick&&t.loginPhoneClick(...n))}:{},{M:o.sr("form","8ce00200-0"),N:o.p({border:!1,rules:e.rules,model:e.formData,["label-position"]:"left"})})}const f=o._export_sfc(m,[["render",a],["__file","C:/Users/sygen/Documents/HBuilderProjects/brushQuestion-front/pages/login/login.vue"]]);wx.createPage(f);
