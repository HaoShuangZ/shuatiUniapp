"use strict";const e=require("../../common/vendor.js"),U=require("../../store/index.js");if(!Array){const R=e.resolveComponent("uni-icons"),_=e.resolveComponent("uni-nav-bar"),b=e.resolveComponent("uni-popup");(R+_+b)()}const q=()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js",G=()=>"../../uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.js",J=()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js";Math||(q+G+J)();const K={__name:"examination",setup(R){e.index.getWindowInfo().windowWidth+"",e.index.getWindowInfo().windowHeight+"",U.useCategory(),e.ref(1),e.ref(!0);const _=e.ref(0),b=e.ref(0);let n=e.ref(0);const x=e.getCurrentInstance(),{$http:p}=x.appContext.config.globalProperties;e.wx$1.getStorageSync("statusBarHeight")+"",e.wx$1.getStorageSync("navigationBarHeight")+"",e.wx$1.getStorageSync("menuButtonHeight")+"";const L=e.wx$1.getStorageSync("statusBarHeight")+e.wx$1.getStorageSync("navigationBarHeight")+"px",Q=()=>{console.log("123"),e.index.navigateBack({delta:1})},m=e.ref(null);let v=e.ref("card");const T=a=>{a=="notes",v.value=a,m.value.open("bottom")};let l=e.ref(0);const $=a=>{l.value=a,S.value=!1,m.value.close()},w=a=>{n.value=a,console.log(n,"questionType")},S=e.ref(!1),z=a=>{S.value=a.show},A=()=>{S.value=!1,m.value.close()};let y=e.ref("");const F=()=>{let a={params:{notesContent:y.value,categoryId:i.value[l.value].categoryId,questionId:i.value[l.value].questionId,userId:e.wx$1.getStorageSync("userInfo").userId,question:i[l.value]},callBack:o=>{console.log("笔记添加成功",o),S.value=!1,m.value.close(),y.value="",e.index.showToast({title:"笔记添加成功",icon:"none",duration:2e3})}};p("addNotes",a)};e.ref([{content:"内容 A"},{content:"内容 B"},{content:"内容 C"}]);let h=e.ref(!1);const H=a=>{l.value=a.detail.current,h.value=i.value[a.detail.current].collectFlag},I=(a,o,t)=>{if(console.log("选择题选择的时候",a,o,t),console.log(a,o,t,"----"),!t.isSelected&&t.questionTypeName==="单选题"){a.isChecked=!0,t.isSelected=!0;let r=0;t.optionsList.map((f,s)=>{f.isRight&&(f.isChecked=!0),f.isChecked&&r++}),r==1?(t.isSelectRight=!0,C.push({categoryId:t.categoryId,questionId:t.questionId,status:1,questionTypeName:t.questionTypeName})):(t.isSelectRight=!1,!t.errorHistoryFlag&&j(t.categoryId,t.questionId,2),C.push({categoryId:t.categoryId,questionId:t.questionId,status:2,questionTypeName:t.questionTypeName})),console.log("处理出错添加的数据",C)}!t.isSelected&&t.questionTypeName==="多选题"&&(console.log("多选题"),a.isChecked=!0)},E=(a,o,t)=>{t.isSelected=!0},P=a=>{console.log("答案报错",a),e.index.setStorageSync("errQuestionDetail",a),e.index.navigateTo({url:"../addErrorQuestion/index?feedType=errAnswerFeed"})},j=(a,o,t)=>{p("addErrQuestion",{params:{categoryId:a,questionId:o,status:t},callBack:f=>{console.log("错题添加成功",f)}})},C=e.reactive([]),D=()=>{p("addErrQuestionList",{params:{questionRecordList:C},callBack:o=>{console.log("批量添加错题记录",o)}})},O=a=>{console.log("收藏问题",a);let o={params:{categoryId:i.value[l.value].categoryId,questionId:i.value[l.value].questionId},callBack:t=>{console.log("问题shouc",t),h.value=!h.value,i.value[l.value].collectFlag=!a,e.index.showToast({title:a?"删除成功":"收藏成功",icon:"none",duration:2e3})}};p(a?"removeCollectQuestion":"collectQuestion",o)};e.computed(()=>i.value[l.value].collectFlag);let i=e.ref([]);const g=e.reactive({page:1,size:10,total:10}),k=["A","B","C","D","E","F"],W=a=>{let o={params:{categoryId:Number(a),page:g.page,size:g.size},callBack:t=>{console.log("res",t.records),t.records.map((r,f)=>{const s=r.options.map(d=>({label:d,isChecked:"",isRight:!1}));let c=[];r.options.map((d,B)=>{r.rightOptions.map((N,X)=>{d===N&&c.push(B)})}),console.log("rightAnswerItem",c),r.rightAnswerItem=c;const u=s.map(d=>(r.rightOptions.includes(d.label)&&(d.isRight=!0),d));r.optionsList=u,r.isSelected=!1}),i.value=t.records,h.value=t.records[l.value].collectFlag,g.page=t.page,g.size=t.size,g.total=t.total}};p("getQuestionList",o)},M=()=>{let a={params:{page:g.page,size:g.size},callBack:o=>{console.log("获取错题数据",o),o.records.map((r,f)=>{const s=r.question.options.map(u=>({label:u,isChecked:"",isRight:!1}));console.log("optionObjects",s);const c=s.map(u=>(r.question.rightOptions.includes(u.label)&&(u.isRight=!0),u));r.question.optionsList=c,r.question.isSelected=!1});let t=o.records.map(r=>r.question);i.value=[...t],h.value=o.records[l.value].collectFlag,g.page=o.page,g.size=o.size,g.total=o.total}};p("getErrorQuestionList",a)};return e.onLoad(a=>{console.log("listType",a),a.listType==0&&W(e.index.getStorageSync("currentCategoryId")),a.listType==11&&(n.value=1,M())}),e.onHide(()=>{console.log("隐藏页面")}),e.onUnload(()=>{console.log("页面销毁"),C.length>0&&D()}),e.onReady(()=>{}),(a,o)=>e.e({a:"overflow:"+(S.value?"hidden":"visible"),b:e.o(Q),c:e.p({type:"back",color:"#000",size:"24"}),d:e.o(t=>w(0)),e:e.unref(n)?"":1,f:e.o(t=>w(1)),g:e.unref(n)?1:"",h:L,i:e.p({["status-bar"]:!0,title:""}),j:e.f(e.unref(i),(t,r,f)=>e.e({a:e.t(t.difficulty),b:e.t(r+1),c:e.t(t.questionTitle),d:t.questionTypeName==="单选题"&&e.unref(n)===0},t.questionTypeName==="单选题"&&e.unref(n)===0?{e:e.f(t.optionsList,(s,c,u)=>e.e({a:!t.isSelected||!s.isChecked},!t.isSelected||!s.isChecked?{b:e.t(k[c])}:{},{c:t.isSelected===!0&&s.isRight?1:"",d:s.isChecked===!0&&s.isChecked!==s.isRight?1:"",e:e.t(s.label),f:t.optionsList.isSelected===!0&&s.isRight?1:"",g:s.isChecked===!0&&s.isChecked!==s.isRight?1:"",h:c,i:e.o(d=>I(s,c,t),c)}))}:{},{f:t.questionTypeName==="多选题"&&e.unref(n)===0},t.questionTypeName==="多选题"&&e.unref(n)===0?{g:e.f(t.optionsList,(s,c,u)=>({a:e.t(k[c]),b:s.isChecked||t.isSelected===!0&&s.isRight?1:"",c:t.isSelected===!0&&s.isChecked===!0&&s.isChecked!==s.isRight?1:"",d:e.t(s.label),e:s.isChecked?1:"",f:t.isSelected===!0&&s.isChecked&&s.isChecked!==s.isRight?1:"",g:c,h:e.o(d=>I(s,c,t),c)}))}:{},e.unref(n)===1?e.e({h:t.questionTypeName==="单选题"},t.questionTypeName==="单选题"?{i:e.f(t.optionsList,(s,c,u)=>e.e({a:!t.isSelected||!s.isChecked},!t.isSelected||!s.isChecked?{b:e.t(s.isRight?null:k[c])}:{},{c:s.isRight?1:"",d:s.isChecked===!0&&s.isChecked!==s.isRight?1:"",e:e.t(s.label),f:s.isRight?1:"",g:s.isChecked===!0&&s.isChecked!==s.isRight?1:"",h:c}))}:{},{j:t.questionTypeName==="多选题"},t.questionTypeName==="多选题"?{k:e.f(t.optionsList,(s,c,u)=>({a:e.t(k[c]),b:s.isRight?1:"",c:t.isSelected===!0&&s.isChecked===!0&&s.isChecked!==s.isRight?1:"",d:e.t(s.label),e:s.isRight?1:"",f:t.isSelected===!0&&s.isChecked&&s.isChecked!==s.isRight?1:"",g:c}))}:{}):{},{l:e.unref(n)===0&&t.questionTypeName=="多选题"&&!t.isSelected},e.unref(n)===0&&t.questionTypeName=="多选题"&&!t.isSelected?{m:e.o(s=>E(a.option,a.optionIndex,t),r)}:{},{n:t.isSelected||e.unref(n)==1},t.isSelected||e.unref(n)==1?{o:e.f(t.options,(s,c,u)=>({a:e.f(t.rightOptions,(d,B,N)=>({a:e.t(s==d?k[c]:""),b:d})),b:c})),p:e.t(a.currentQuestionRightItem),q:e.o(s=>P(t),r)}:{},{r:t.isSelected||e.unref(n)==1},t.isSelected||e.unref(n)==1?{}:{},{s:t.isSelected||e.unref(n)==1},t.isSelected||e.unref(n)==1?{t:e.t(t.analysis),v:e.o(s=>T("notes"),r)}:{},{w:r})),k:e.unref(n)===1,l:e.unref(l),m:e.o(H),n:!e.unref(h)},e.unref(h)?{}:{},{o:e.o(t=>O(e.unref(h))),p:e.t(_.value),q:e.t(b.value),r:e.o(t=>T("card")),s:e.unref(v)==="card"},e.unref(v)==="card"?{t:e.f(e.unref(i),(t,r,f)=>e.e({a:e.t(t.isSelectRight),b:e.t(r+1),c:t.collectFlag},t.collectFlag?{}:{},{d:t.errorHistoryFlag?1:"",e:t.errorHistoryFlag?1:"",f:e.unref(l)==r?1:"",g:e.o(s=>$(r),r),h:r})),v:""}:{},{w:e.unref(v)==="notes"},e.unref(v)==="notes"?{x:e.o(A),y:e.p({type:"closeempty",size:"20"}),z:e.o(F),A:e.unref(y),B:e.o(t=>e.isRef(y)?y.value=t.detail.value:y=t.detail.value)}:{},{C:e.sr(m,"6aa1d910-2",{k:"popup"}),D:e.o(z),E:e.p({["background-color"]:"#fff"})})}},V=e._export_sfc(K,[["__file","C:/Users/sygen/Documents/HBuilderProjects/brushQuestion-front/pages/examination/examination.vue"]]);wx.createPage(V);
