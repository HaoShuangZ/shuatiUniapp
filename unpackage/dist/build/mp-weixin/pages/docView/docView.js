"use strict";const e=require("../../common/vendor.js"),o=require("../../utils/config.js");if(!Array){(e.resolveComponent("uni-popup-dialog")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const n={__name:"docView",setup(n){e.getCurrentInstance().appContext.config.globalProperties,e.onLoad((o=>{console.log(o,"跳转携带的参数",e.index.getStorageSync("docDetail"))})),e.onShow((()=>{Object.assign(a,{...e.index.getStorageSync("docDetail")})}));const t=e.ref(null),i=e.index.getStorageSync("userInfo");let a=e.reactive({});return(n,s)=>({a:e.t(e.unref(a).docName),b:e.t(e.unref(a).type),c:".docx"===e.unref(a).type?"../../static/doc.png":`../../static/${e.unref(a).type}.png`,d:e.t(e.unref(a).updateTime),e:e.t(e.unref(a).freeFlag?"免费":"开通VIP下载"),f:e.f(e.unref(a).tags,((o,n,t)=>({a:e.t(o),b:o}))),g:e.f(e.unref(a).previewImages,((e,o,n)=>({a:e,b:e}))),h:e.o((n=>{return t=e.unref(a).downloadFlag,void(i.vipFlag?(e.index.showToast({title:"加载中",icon:"loading"}),e.index.downloadFile({url:`${o.baseUrl}/document/download?downloadFlag=${t}`,header:{"Ac-Token":e.index.getStorageSync("token")||""},success:o=>{if(console.log(o,"下载的res"),200===o.statusCode){if("application/json;charset=utf-8"===o.header["Content-Type"])return console.log("res----",o),void e.index.showToast({title:"下载次数已上限!",icon:"error"});e.index.saveFile({tempFilePath:o.tempFilePath,success:o=>{console.log("e下载文件的地址",o),setTimeout((()=>{e.index.hideLoading(),e.index.openDocument({filePath:o.savedFilePath,success:e=>{console.log("openDocument",e)},fail:o=>{e.index.showToast({title:"打开失败"+o})}})}),200)},fail:o=>{e.index.showToast({title:"保存失败"+o})}})}},fail:o=>{e.index.showToast({title:"文件下载失败"+o,icon:"none"})}})):e.index.showModal({title:"提示",content:"您未开通VIP,开通后可以下载!",confirmText:"去开通",success:function(o){o.confirm?e.index.navigateTo({url:"../../pages/vip/vip"}):o.cancel&&console.log("用户点击取消")}}));var t})),i:e.o(n.dialogConfirm),j:e.o(n.dialogClose),k:e.p({type:"error",cancelText:"取消",confirmText:"去开通",title:"提示",content:"您未开通VIP,开通后可以下载!"}),l:e.sr(t,"39c07f28-0",{k:"alertDialog"}),m:e.p({type:"dialog"}),n:e.sr("popup","39c07f28-2"),o:e.o(n.change),p:e.p({"background-color":"#fff"})})}};wx.createPage(n);
