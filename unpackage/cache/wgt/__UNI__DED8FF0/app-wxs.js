var __wxsModules={};
__wxsModules.b6a9b97a=(()=>{var R=(e,a)=>()=>(a||e((a={exports:{}}).exports,a),a.exports);var K=R((N,D)=>{var X="",Y=0,t={left:0,top:0,width:0,height:0},i={left:0,top:0,width:0,height:0},v=[],d="",o={frame:{left:0,top:0,width:0,height:0},image:{left:0,top:0,width:0,height:0}};function T(e){X=e}function U(e,a,r,g){Y=e,b(r)}function j(e,a,r,g){t=e,b(r)}function k(e,a,r,g){i=e,b(r)}function b(e){setTimeout(()=>{S(e)})}function z(e,a){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),v=e.touches;var r=e.instance;return r.hasClass("body")?d="body":r.hasClass("frame-left-top")?d="left-top":r.hasClass("frame-left-bottom")?d="left-bottom":r.hasClass("frame-right-top")?d="right-top":r.hasClass("frame-right-bottom")&&(d="right-bottom"),o.frame.left=i.left,o.frame.top=i.top,o.frame.width=i.width,o.frame.height=i.height,o.image.left=t.left,o.image.top=t.top,o.image.width=t.width,o.image.height=t.height,!1}function A(e,a){var r=e.instance;if(v.length==1)d=="body"?G(v[0],e.touches[0],a):J(v[0],e.touches[0],a);else if(v.length==2&&e.touches.length==2){var g=v[0],n=v[1],h=e.touches[0],f=e.touches[1];if(g.identifier!=h.identifier){var l=h;h=f,f=l}H(g,n,h,f,a)}}function B(e,a){v=[],a.callMethod("updateData",{frame:i,image:t})}function E(e,a){v=[],a.callMethod("updateData",{frame:i,image:t})}function G(e,a,r){var g=a.clientX-e.clientX,n=a.clientY-e.clientY;t.left=o.image.left+g,t.top=o.image.top+n;var h=i.left,f=i.top,l=i.width,p=i.height;t.left>h&&(t.left=h),t.top>f&&(t.top=f),t.left+t.width<h+l&&(t.left=h+l-t.width),t.top+t.height<f+p&&(t.top=f+p-t.height),S(r)}function H(e,a,r,g,n){var h=e.clientX,f=e.clientY,l=a.clientX,p=a.clientY,u=r.clientX,w=r.clientY,x=g.clientX,y=g.clientY,m=Math.sqrt((h-l)*(h-l)+(f-p)*(f-p)),C=Math.sqrt((u-x)*(u-x)+(w-y)*(w-y)),c=(h+l)/2,M=(f+p)/2,I=(u+x)/2,F=(w+y)/2,q=I-c,P=F-M,s=C/m;o.image.width*s<i.width&&(s=i.width/o.image.width),o.image.height*s<i.height&&(s=i.height/o.image.height),o.image.width*s<i.width&&(s=i.width/o.image.width),t.left=o.image.left+q-(c-o.image.left)*(s-1),t.top=o.image.top+P-(M-o.image.top)*(s-1),t.width=o.image.width*s,t.height=o.image.height*s,t.left>i.left&&(t.left=i.left),t.top>i.top&&(t.top=i.top),t.left+t.width<i.left+i.width&&(t.left=i.left+i.width-t.width),t.top+t.height<i.top+i.height&&(t.top=i.top+i.height-t.height),S(n)}function J(e,a,r){var g=a.clientX-e.clientX,n=a.clientY-e.clientY,h=o.frame.left,f=o.frame.top,l=o.frame.left+o.frame.width,p=o.frame.top+o.frame.height,u=!1,w=!1,x=!1,y=!1,m=30,C=i.width/i.height;if(d=="left-top"?(h+=g,f+=n,u=!0,w=!0):d=="left-bottom"?(h+=g,p+=n,u=!0,y=!0):d=="right-top"?(l+=g,f+=n,x=!0,w=!0):d=="right-bottom"&&(l+=g,p+=n,x=!0,y=!0),h<t.left&&(h=t.left),f<t.top&&(f=t.top),l>t.left+t.width&&(l=t.left+t.width),p>t.top+t.height&&(p=t.top+t.height),u&&h>l-m&&(h=l-m),w&&f>p-m&&(f=p-m),x&&l<h+m&&(l=h+m),y&&p<f+m&&(p=f+m),u&&X!="free"){var c=l-C*(p-f);h<c&&(h=c)}if(w&&X!="free"){var c=p-(l-h)/C;f<c&&(f=c)}if(x&&X!="free"){var c=C*(p-f)+h;l>c&&(l=c)}if(y&&X!="free"){var c=(l-h)/C+f;p>c&&(p=c)}i.left=h,i.top=f,i.width=l-h,i.height=p-f,S(r)}function S(e){e.selectComponent(".frame").setStyle({left:i.left+"px",top:i.top+"px",width:i.width+"px",height:i.height+"px"}),e.selectComponent(".image-wrap").setStyle({left:t.left+"px",top:t.top+"px",width:t.width+"px",height:t.height+"px"}),e.selectComponent(".image-rect").setStyle({left:t.left-i.left+"px",top:t.top-i.top+"px",width:t.width+"px",height:t.height+"px"});var a=0,r=0,g=t.width,n=t.height;Y%180!=0&&(g=t.height,n=t.width,r=g/2-n/2,a=n/2-g/2),e.selectComponent(".image-wrap .image").setStyle({left:a+"px",top:r+"px",width:g+"px",height:n+"px",transform:"rotate("+Y+"deg)"}),e.selectComponent(".image-rect .image").setStyle({left:a+"px",top:r+"px",width:g+"px",height:n+"px",transform:"rotate("+Y+"deg)"})}D.exports={changeMode:T,changeRotate:U,changeImage:j,changeFrame:k,touchstart:z,touchmove:A,touchend:B,touchcancel:E}});return K();})();
